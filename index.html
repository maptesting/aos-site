<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AOS â€” AI Receptionist Prompt Pack (Free Builder)</title>

  <!-- SEO -->
  <meta name="description" content="Build your own AI Receptionist in 30 seconds â€” free. Generate prompts, workflows, and voice previews for any business.">
  <meta property="og:title" content="AOS â€” Free AI Receptionist Builder">
  <meta property="og:description" content="Generate a custom AI receptionist instantly â€” prompt, workflows, and voice demo included.">
  <meta property="og:image" content="https://yourdomain.com/og-preview.png">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">

  <!-- Favicon -->
  <link rel="icon" href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y=".9em" font-size="90">ðŸ¤–</text></svg>'>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = { theme: { extend: {
      colors:{ brand:{500:"#556dff",600:"#3d4fe6"}, ink:"#0b0f1a" },
      boxShadow:{ soft:"0 8px 30px rgba(0,0,0,.18)" }
    }}};
  </script>
  <style>
    body{background:#0b0f1a;color:#fff}
    .gradient{background:
      radial-gradient(1200px 600px at 20% -10%, rgba(85,109,255,.25), transparent 60%),
      radial-gradient(1000px 600px at 100% 0%, rgba(34,42,130,.35), transparent 60%);}
    .glass{backdrop-filter:blur(10px);background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08)}
    .code{white-space:pre-wrap;font-family:ui-monospace,Menlo,Consolas,monospace}
    input,textarea,select{background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.1);border-radius:12px;padding:.9rem 1rem}
    input::placeholder,textarea::placeholder{color:rgba(255,255,255,.4)}
    input:focus,textarea:focus,select:focus{outline:none;box-shadow:0 0 0 2px rgba(85,109,255,.5)}
    .range {appearance:none;height:6px;border-radius:9999px;background:linear-gradient(to right,#556dff var(--pct,0%),rgba(255,255,255,.2) 0)}
    .range::-webkit-slider-thumb{appearance:none;width:14px;height:14px;border-radius:9999px;background:#fff;border:2px solid #556dff;box-shadow:0 0 0 3px rgba(85,109,255,.25)}
  </style>
</head>
<body>
  <header class="gradient border-b border-white/10">
    <div class="max-w-6xl mx-auto px-4 py-6 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="w-9 h-9 rounded-xl bg-brand-500 grid place-items-center">ðŸ¤–</div>
        <div>
          <div class="font-semibold">AOS</div>
          <div class="text-white/60 text-xs">AI Optimization Solutions</div>
        </div>
      </div>
      <a href="#builder" class="px-4 py-2 rounded-xl bg-brand-500 hover:bg-brand-600">Build Free</a>
    </div>
  </header>

  <!-- Hero -->
  <section class="relative gradient overflow-hidden">
    <div class="mx-auto max-w-7xl px-4 pt-20 pb-16 md:pt-24 md:pb-24">
      <div class="grid md:grid-cols-2 gap-16 items-start">
        <div>
          <h1 class="text-4xl md:text-5xl font-extrabold leading-tight">
            AI Receptionist Prompt Pack â€” <span class="text-brand-500">Free Builder</span>
          </h1>
          <p class="mt-6 text-white/70 max-w-2xl leading-relaxed">
            Answer a few questions about your business. Get a production-ready System Prompt (preview) and
            download two <b>n8n</b> workflows â€” <em>checkAvailability</em> and <em>bookAppointment</em>.
          </p>
          <div class="mt-8">
            <a href="#builder" class="px-5 py-3 rounded-xl bg-brand-500 hover:bg-brand-600">Start Building</a>
          </div>
        </div>

        <!-- Demo chat -->
        <div class="glass rounded-2xl p-6 md:p-8 shadow-soft mt-6 md:mt-0">
          <div class="text-sm text-white/60 mb-2">Talk to Ava â€” Receptionist at BrightSmile Dental Clinic</div>
          <div id="chatBox" class="h-64 overflow-y-auto bg-black/20 rounded-xl p-3 space-y-3 text-sm border border-white/10">
            <div class="flex gap-3">
              <div class="w-8 h-8 rounded-full bg-brand-500 grid place-items-center">ðŸ¤–</div>
              <div>Hi! This is Ava from BrightSmile Dental â€” how can I help you today?</div>
            </div>
          </div>
          <form id="chatForm" class="mt-3 flex gap-2" action="javascript:void(0)" autocomplete="off">
            <input id="chatInput" type="text" placeholder="Type your message..." class="flex-1 bg-white/5 border border-white/10 rounded-xl px-3 py-2 text-sm" required>
            <button id="chatSend" type="submit" class="bg-brand-500 hover:bg-brand-600 rounded-xl px-4 py-2 text-sm font-medium">Send</button>
          </form>
        </div>
      </div>
    </div>
  </section>

  <!-- Builder -->
  <section id="builder" class="py-24 md:py-32 scroll-mt-28">
    <div class="max-w-6xl mx-auto px-4">
      <h2 class="text-center text-3xl font-bold mb-10 text-white">Build your AI Receptionist here ðŸ‘‡</h2>
      <div class="glass rounded-2xl p-6 md:p-10">
        <div class="flex items-start justify-between gap-12 flex-col lg:flex-row">
          <!-- Form -->
          <div class="w-full lg:w-1/2">
            <h3 class="text-2xl font-semibold mb-4">Your Business</h3>
            <form id="aiForm" class="grid gap-4 mt-4">
              <input name="bizName" placeholder="Business Name" required>
              <input name="location" placeholder="Location / Service area" required>
              <input name="industry" placeholder="Industry (e.g., salon, rentals, clinic)" required>
              <input name="services" placeholder="Services (comma-separated)" required>
              <div class="grid md:grid-cols-2 gap-4">
                <input name="agentName" placeholder="Agent Name" value="Alex">
                <input name="language" placeholder="Language" value="English">
              </div>
              <div class="grid md:grid-cols-2 gap-4">
                <input name="hours" placeholder="Hours (e.g., Monâ€“Sat 9â€“6)">
                <input name="timezone" placeholder="Timezone (e.g., America/New_York)">
              </div>
              <div class="grid md:grid-cols-2 gap-4">
                <input name="calendarId" placeholder="Google Calendar ID (e.g., primary)">
                <input name="email" type="email" placeholder="Confirmation email sender (optional)">
              </div>
              <textarea name="policies" rows="2" placeholder="Policies / deposits / refunds (optional)"></textarea>

              <!-- Voice picker row -->
              <div class="grid md:grid-cols-2 gap-4 items-end">
                <div>
                  <label class="block text-sm text-white/70 mb-1" for="voiceSelect">Voice</label>
                  <select id="voiceSelect">
                    <option>Loading voicesâ€¦</option>
                  </select>
                </div>
                <div class="mt-3 md:mt-0 flex gap-3 flex-wrap">
                  <button type="button" id="previewBtn" class="px-4 py-3 rounded-xl bg-brand-500 hover:bg-brand-600 font-medium inline-flex items-center gap-2">
                    <span id="previewSpinner" class="hidden inline-block w-4 h-4 border-2 border-white/40 border-t-white rounded-full animate-spin"></span>
                    <span>Generate Preview</span>
                  </button>
                  <button type="button" id="ttsBtn" class="px-4 py-3 rounded-xl border border-white/10 hover:bg-white/5 font-medium">â–¶ Hear AI Greeting</button>
                </div>
              </div>
            </form>
          </div>

          <!-- Preview + Downloads + Audio -->
          <div class="w-full lg:w-1/2">
            <div class="glass rounded-2xl p-5 h-full">
              <h3 class="text-xl font-semibold">System Prompt â€” Preview</h3>
              <div class="text-xs text-white/60">Preview only (truncated)</div>
              <div id="promptOut" class="code text-sm bg-black/30 rounded-xl p-4 border border-white/10 min-h-[280px] mt-3"></div>

              <div class="mt-6">
                <h4 class="text-sm font-semibold text-white/80 mb-2">Downloads</h4>
                <div class="flex flex-wrap gap-2">
                  <button id="downloadPromptBtn" class="px-4 py-2 rounded-xl bg-brand-500/80 hover:bg-brand-600 font-medium disabled:opacity-50" disabled>Download Full Prompt (.txt)</button>
                  <button id="downloadAvailBtn" class="px-4 py-2 rounded-xl border border-white/10 hover:bg-white/5 disabled:opacity-50" disabled>Download: checkAvailability.json</button>
                  <button id="downloadBookBtn" class="px-4 py-2 rounded-xl border border-white/10 hover:bg-white/5 disabled:opacity-50" disabled>Download: bookAppointment.json</button>
                </div>
                <div id="successMsg" class="hidden mt-3 text-sm text-green-400">Downloaded âœ…</div>
              </div>

              <!-- Custom Audio Player -->
              <div class="mt-6">
                <audio id="audio" class="hidden"></audio>
                <div id="audioUI" class="hidden glass rounded-xl p-4">
                  <div class="flex items-center gap-3">
                    <button id="audioPlay" class="w-10 h-10 rounded-full bg-brand-500 hover:bg-brand-600 grid place-items-center text-black font-bold">â–¶</button>
                    <div class="flex-1">
                      <input id="audioSeek" type="range" min="0" max="100" value="0" class="w-full range">
                      <div class="flex justify-between text-xs text-white/60 mt-1">
                        <span id="audioTime">0:00</span>
                        <span id="audioDur">0:00</span>
                      </div>
                    </div>
                    <a id="audioDownload" download="ai-greeting.mp3" class="text-sm underline decoration-blue-400">Download</a>
                  </div>
                </div>
                <div id="notice" class="mt-2 text-xs text-white/60"></div>
                <div id="debug" class="mt-2 text-xs text-red-400"></div>
              </div>
            </div>
          </div>
        </div>

      </div>

      <!-- Tutorial video -->
      <div class="mt-10">
        <h3 class="text-xl font-semibold mb-3">How to use this builder (video)</h3>
        <div class="rounded-2xl overflow-hidden border border-white/10 shadow-soft aspect-video">
          <iframe
            class="w-full h-full"
            src="https://www.youtube.com/embed/Akwe5h3CQKo?si=Q-Uto-rIMjTar1vv"
            title="AOS â€” How to use the AI Receptionist Builder"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
            referrerpolicy="strict-origin-when-cross-origin"
            allowfullscreen></iframe>
        </div>
      </div>

      <p class="text-center text-sm text-white/50 mt-8">
        After import, attach your Google Calendar OAuth2 and OpenAI credentials in n8n.
      </p>
    </div>
  </section>

  <footer class="py-10 text-center text-white/40 text-sm">
    Â© <span id="year"></span> AOS â€” AI Optimization Solutions
  </footer>
  <script>document.getElementById('year').textContent = new Date().getFullYear();</script>

  <!-- ====== EMBEDDED TEMPLATES (unchanged) ====== -->
  <!-- tplCheckAvailability & tplBookAppointment blocks here EXACTLY as you had them -->
  <!-- (kept for brevity) -->
  <!-- ====== /EMBEDDED TEMPLATES ====== -->

  <!-- Logic -->
  <script>
  (function(){
    const $ = (id)=>document.getElementById(id);

    /* Chat (unchanged) */
    function addMsg(role, text){
      const wrap = $('chatBox'); if(!wrap) return;
      const row = document.createElement('div');
      row.className = 'flex gap-3';
      if(role==='user'){ row.className += ' justify-end'; }
      row.innerHTML = role==='user'
        ? `<div class="max-w-[75%] bg-brand-500/20 rounded-xl px-3 py-2">${escapeHtml(text)}</div>`
        : `<div class="w-8 h-8 rounded-full bg-brand-500 grid place-items-center">ðŸ¤–</div><div class="max-w-[75%] bg-white/5 rounded-xl px-3 py-2">${escapeHtml(text)}</div>`;
      wrap.appendChild(row);
      wrap.scrollTop = wrap.scrollHeight;
    }
    function escapeHtml(s){return (s||'').replace(/[&<>"']/g,m=>({ "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;" }[m]))}
    function wireChat(){
      const form=$('chatForm'), input=$('chatInput');
      if(!form || !input) return;
      form.addEventListener('submit',(e)=>{
        e.preventDefault();
        const t=input.value.trim(); if(!t) return;
        addMsg('user', t);
        input.value='';
        setTimeout(()=>addMsg('bot', "Thanks! (Demo chat only) â€” the real receptionist runs in your n8n workflows."), 400);
      });
      $('chatSend')?.addEventListener('click',()=>form.requestSubmit());
    }

    /* Form values + prompt (unchanged) */
    function getValues(){
      const form = $('aiForm'); if(!form) return {};
      const v = Object.fromEntries(new FormData(form).entries());
      try{ v.timezone ||= Intl.DateTimeFormat().resolvedOptions().timeZone || ""; }catch{}
      v.agentName ||= 'Alex'; v.language ||= 'English';
      return v;
    }
    const truncate=(s,n=1200)=> s && s.length>n ? s.slice(0,n)+' â€¦' : (s||'');

    function buildPrompt(v={}){
      const tz=v.timezone||'America/New_York', biz=v.bizName||'the business', agent=v.agentName||'Alex';
      const industry=v.industry||'services', services=v.services||'General services', hours=v.hours||'Monâ€“Fri 9:00â€“17:00';
      const location=v.location||'Local area', policies=v.policies||'Standard policies apply.', emailFrom=v.email||'no-reply@example.com';
      const now=(()=>{try{return new Date().toLocaleString('en-US',{timeZone:tz,weekday:'long',year:'numeric',month:'long',day:'2-digit',hour:'2-digit',minute:'2-digit'})}catch{return new Date().toLocaleString()}})();
      const L=(x,l)=>`${l}: ${x||'N/A'}`;
      return [
`# ROLE
You are ${agent}, a friendly, efficient AI receptionist for **${biz}** (${industry}). Keep replies to 1â€“2 sentences, natural and clear.

# CURRENT TIME
- Current time: **${now}**
- Timezone: **${tz}**
Use ISO 8601 timestamps when interacting with tools.

# BUSINESS CONTEXT
${L(biz,'Business')}
${L(location,'Location / Service')}
${L(industry,'Industry')}
${L(services,'Services')}
${L(hours,'Hours')}
${L(policies,'Policies')}

# TASK
Answer questions and help book appointments quickly.

# BOOKING FLOW
1) Ask for the preferred date/time (within ${hours}).
2) Check the requested slot.
3) If unavailable, propose up to 3 close alternatives (same day or next business day).
4) Collect full name, email, phone.
5) Confirm slot and create the booking.
6) Summarize details and say a confirmation will be sent from **${emailFrom}**.

# STYLE & RULES
Warm, concise, confident; use contractions. Donâ€™t invent availability outside ${hours}. Confirm final date/time + contact details.`
      ].join('\n');
    }

    function wirePromptDownload(){
      const btn = $('downloadPromptBtn'); if(!btn) return;
      btn.disabled = false;
      btn.onclick = (e)=>{
        e.preventDefault();
        const txt = buildPrompt(getValues());
        const a = document.createElement('a');
        a.href = URL.createObjectURL(new Blob([txt], { type:'text/plain;charset=utf-8' }));
        a.download = `${(getValues().bizName || 'AI_Receptionist')}_prompt.txt`;
        a.click(); URL.revokeObjectURL(a.href);
        const ok=$('successMsg'); if(ok){ ok.textContent='Prompt downloaded âœ…'; ok.classList.remove('hidden'); setTimeout(()=>ok.classList.add('hidden'),2000); }
      };
    }

    /* Workflows (unchanged) */
    function readTplObject(id){
      const node=$(id); if(!node) throw new Error('Missing template node: '+id);
      const text=node.textContent??''; if(!text.trim()) throw new Error('Empty template: '+id);
      return JSON.parse(text);
    }
    const slug=(s)=> (s||'').toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/^-+|-+$/g,'').slice(0,48)||'biz';
    function setWorkflowTimezone(obj, tz){ obj.settings=obj.settings||{}; obj.settings.timezone = tz || obj.settings.timezone || 'America/New_York'; }
    function patchCalendarToolNode(obj, idOrPrimary){
      (obj.nodes||[]).forEach(n=>{
        if(n?.type==='n8n-nodes-base.googleCalendarTool' && n.parameters?.calendar && typeof n.parameters.calendar==='object'){
          n.parameters.calendar.value = idOrPrimary;
          n.parameters.calendar.cachedResultName = idOrPrimary;
        }
      });
    }
    function patchWebhookPath(obj, newPath){
      (obj.nodes||[]).forEach(n=>{
        if(n?.type==='n8n-nodes-base.webhook' && n.parameters){ n.parameters.path = newPath || n.parameters.path; }
      });
    }
    function renderWorkflow(tplId, v, kind){
      const obj=readTplObject(tplId);
      setWorkflowTimezone(obj, v.timezone);
      patchCalendarToolNode(obj, v.calendarId || 'primary');
      const base = 'aos-'+slug(v.bizName);
      patchWebhookPath(obj, kind==='book' ? `${base}-book` : `${base}-check`);
      return JSON.stringify(obj, null, 2);
    }
    function enableDownload(btnId, text, name){
      const btn=$(btnId); if(!btn) return;
      btn.disabled=false; btn.onclick=(e)=>{
        e.preventDefault();
        const a=document.createElement('a');
        a.href=URL.createObjectURL(new Blob([text],{type:'application/json'}));
        a.download=name; a.click(); URL.revokeObjectURL(a.href);
        const ok=$('successMsg'); if(ok){ ok.textContent=name+' downloaded âœ…'; ok.classList.remove('hidden'); setTimeout(()=>ok.classList.add('hidden'),2000); }
      };
    }

    /* Audio player */
    function fmt(s){ s = Math.max(0, s|0); const m=(s/60)|0, sec=(s%60)|0; return m+':'+(sec<10?'0':'')+sec; }
    function wireAudioUI(){
      const a=$('audio'), box=$('audioUI'); if(!a || !box) return;
      const btn=$('audioPlay'), seek=$('audioSeek'), t=$('audioTime'), d=$('audioDur');
      function sync(){
        if(!isFinite(a.duration)) return;
        d.textContent = fmt(a.duration);
        t.textContent = fmt(a.currentTime);
        const pct = a.currentTime / Math.max(1, a.duration) * 100;
        seek.value = pct;
        seek.style.setProperty('--pct', pct+'%');
        btn.textContent = a.paused ? 'â–¶' : 'â¸';
      }
      btn.addEventListener('click',()=>{ a.paused ? a.play() : a.pause(); });
      a.addEventListener('play', sync);
      a.addEventListener('pause', sync);
      a.addEventListener('timeupdate', sync);
      a.addEventListener('loadedmetadata', ()=>{ box.classList.remove('hidden'); sync(); });
      seek.addEventListener('input', ()=>{
        const pct = parseFloat(seek.value||'0')/100;
        if(isFinite(a.duration)) a.currentTime = a.duration*pct;
        seek.style.setProperty('--pct', seek.value+'%');
      });
    }

    /* Preview action */
    async function doPreview(){
      const spinner=$('previewSpinner'), btn=$('previewBtn'), out=$('promptOut');
      btn.disabled=true; spinner?.classList.remove('hidden');
      try{
        const v=getValues();
        out.textContent = (truncate(buildPrompt(v)));
        wirePromptDownload();
        const avail = renderWorkflow('tplCheckAvailability', v, 'check');
        const book  = renderWorkflow('tplBookAppointment',  v, 'book');
        enableDownload('downloadAvailBtn', avail, 'checkAvailability.json');
        enableDownload('downloadBookBtn',  book,  'bookAppointment.json');
        const n=$('notice'); if(n) n.textContent='Downloads ready. JSONs customized with your Calendar ID, Timezone, and unique webhook paths.';
      }catch(e){ console.error(e); alert('Error preparing downloads: '+e.message); }
      finally{ spinner?.classList.add('hidden'); btn.disabled=false; }
    }

    /* Voices + TTS */
    async function loadVoices() {
      const sel = $('voiceSelect'); if (!sel) return;
      try {
        const r = await fetch('/api/voices');
        const j = await r.json();
        sel.innerHTML = '';
        if (j.ok && Array.isArray(j.data.voices) && j.data.voices.length) {
          j.data.voices.forEach(v => {
            const opt = document.createElement('option');
            opt.value = v.id;
            opt.textContent = v.name;
            sel.appendChild(opt);
          });
          return;
        }
      } catch {}
      // fallback if API missing
      sel.innerHTML = '';
      [
        { id:'', name:'Default' },
        { id:'56bWURjYFHyYyVf490Dp', name:'Emma' },
        { id:'UgBBYS2sOqTuMpoF3BR0', name:'Mark' }
      ].forEach(v=>{
        const opt=document.createElement('option');
        opt.value=v.id; opt.textContent=v.name; sel.appendChild(opt);
      });
    }

    async function doTTS(){
      const ttsBtn = $('ttsBtn');
      if (ttsBtn) ttsBtn.disabled = true;          // prevent double-clicks (avoids 429)
      const v=getValues();
      const voice_id = ($('voiceSelect')?.value)||'';
      const text=`Hey, this is ${v.agentName||'Alex'} with ${v.bizName||'your business'}. How can I help you today?`;

      async function call(body){
        const res = await fetch('/api/tts', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(body) });
        let data=null; try{ data=await res.json(); }catch{}
        if(!res.ok || !data?.ok){
          const msg = data?.message || `HTTP ${res.status}`;
          const code= data?.code || 'UNKNOWN';
          throw new Error(`[${code}] ${msg}`);
        }
        return data.data.audioBase64;
      }

      try{
        let audioB64;
        try{
          const body = { text };
          if (voice_id) body.voice_id = voice_id;
          audioB64 = await call(body);
        }catch(e){
          // ElevenLabs concurrency or voice perms: retry once with default
          if(String(e.message).includes('[UPSTREAM]')){
            audioB64 = await call({ text });
          } else {
            throw e;
          }
        }
        const a=$('audio');
        a.src = audioB64;
        a.load();
        $('audioDownload').href = audioB64;
        await a.play().catch(()=>{});
      }catch(e){
        console.error(e);
        alert('TTS failed: '+ e.message);
      } finally {
        if (ttsBtn) ttsBtn.disabled = false;
      }
    }

    // Wire events
    document.addEventListener('click',(ev)=>{
      if(ev.target.closest('#previewBtn')){ ev.preventDefault(); doPreview(); }
      if(ev.target.closest('#ttsBtn')){ ev.preventDefault(); doTTS(); }
    });

    function init(){
      wireChat(); wireAudioUI(); loadVoices();
    }
    if(document.readyState==='loading') document.addEventListener('DOMContentLoaded', init); else init();
  })();
  </script>
</body>
</html>
