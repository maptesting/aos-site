<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>AOS ‚Äì Instant AI Receptionist Builder</title>
  <meta name="description" content="Generate a custom AI receptionist for any business in minutes. Preview, hear an ElevenLabs voice greeting, and download your prompt + n8n workflow after purchase." />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ü§ñ</text></svg>">

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            brand: {50:"#f5f8ff",100:"#eaf0ff",200:"#cfdcff",300:"#a5baff",400:"#7991ff",500:"#556dff",600:"#3d4fe6",700:"#2f3bb4",800:"#222a82",900:"#141a51"},
            ink:"#0b0f1a"
          },
          boxShadow:{ soft:"0 8px 30px rgba(0,0,0,.08)" }
        }
      }
    }
  </script>
  <style>
    .glass { backdrop-filter: blur(10px); background: rgba(255,255,255,.06); border: 1px solid rgba(255,255,255,.08); }
    .gradient { background: radial-gradient(1200px 600px at 20% -10%, rgba(85,109,255,.25), transparent 60%), radial-gradient(1000px 600px at 100% 0%, rgba(34,42,130,.35), transparent 60%), linear-gradient(180deg, #0b0f1a 0%, #0b0f1a 100%); }
    html { scroll-behavior: smooth; }
    .site-logo { width: 36px; height: 36px; object-fit: contain; border-radius: .75rem; }
    .code { white-space: pre-wrap; font-family: ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace; }
    select, select option { background-color: rgba(255,255,255,.08)!important; color:#fff!important; }
    select:focus, input:focus, textarea:focus { outline: none; box-shadow: 0 0 0 2px rgba(85,109,255,.6); }
  </style>

  <!-- Stripe Buy Button -->
  <script async src="https://js.stripe.com/v3/buy-button.js"></script>

  <!-- SEO Schema -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"Organization",
    "name":"AOS ‚Äì AI Optimization Solutions",
    "url":"https://your-domain.com/",
    "logo":"images/logo/ChatGPT Image Oct 26, 2025, 04_40_34 PM.png",
    "description":"Generate a custom AI receptionist for any business, anywhere."
  }
  </script>
</head>
<body class="bg-ink text-white antialiased selection:bg-brand-300/30">

  <!-- Top notice -->
  <div class="bg-brand-900/40 border-b border-white/10 text-sm">
    <div class="mx-auto max-w-7xl px-4 py-2 text-center">
      Build a custom AI receptionist for <b>any business</b> ‚Äî preview free, hear an ElevenLabs voice intro, download after purchase.
      <a href="#builder" class="ml-2 underline decoration-brand-400 hover:text-brand-300">Start building ‚Üí</a>
    </div>
  </div>

  <!-- Header -->
  <header class="sticky top-0 z-50 bg-ink/70 glass">
    <div class="mx-auto max-w-7xl px-4">
      <div class="flex h-16 items-center justify-between">
        <a href="#" class="flex items-center gap-3">
          <img src="images/logo/ChatGPT Image Oct 26, 2025, 04_40_34 PM.png" alt="AOS logo" class="site-logo" />
          <div class="leading-tight">
            <div class="font-semibold tracking-tight">AOS</div>
            <div class="text-xs text-white/60">AI Optimization Solutions</div>
          </div>
        </a>
        <nav class="hidden md:flex items-center gap-8 text-sm">
          <a href="#features" class="hover:text-brand-300">Features</a>
          <a href="#builder" class="hover:text-brand-300">AI Builder</a>
          <a href="#faq" class="hover:text-brand-300">FAQ</a>
        </nav>
        <div class="flex items-center gap-3">
          <a href="#builder" class="inline-flex text-sm px-4 py-2 rounded-xl bg-brand-500 hover:bg-brand-600">Build & Buy</a>
        </div>
      </div>
    </div>
  </header>

  <!-- Hero -->
  <section class="relative gradient overflow-hidden">
    <div class="mx-auto max-w-7xl px-4 pt-16 pb-24 md:pt-24 md:pb-28">
      <div class="grid md:grid-cols-2 gap-10 items-center">
        <div>
          <div class="inline-flex items-center gap-2 rounded-full border border-white/10 px-3 py-1 text-xs text-white/70 mb-5">
            <span>ü§ñ Instant AI Receptionist Builder</span><span class="opacity-30">‚Ä¢</span><span>Any Business ‚Ä¢ Any Country</span>
          </div>
          <h1 class="text-4xl md:text-6xl font-extrabold tracking-tight leading-tight">
            Turn inquiries into <span class="text-brand-400">booked customers</span>‚Äîautomatically.
          </h1>
          <p class="mt-5 text-white/70 max-w-xl">
            Answer a few questions about your business. Get a tailored system prompt + an import-ready n8n workflow JSON. Works with ChatGPT, Claude, Gemini, and more.
          </p>
          <div class="mt-8 flex flex-wrap gap-3">
            <a href="#builder" class="px-5 py-3 rounded-xl bg-brand-500 hover:bg-brand-600 font-medium">Build your AI now</a>
          </div>
        </div>

        <div class="relative">
          <div class="glass rounded-2xl p-6 md:p-8 shadow-soft">
            <div class="text-sm text-white/60">Live conversation</div>
            <div class="mt-3 space-y-3">
              <div class="flex items-start gap-3">
                <div class="h-9 w-9 rounded-full bg-brand-500 grid place-items-center">ü§ñ</div>
                <div class="flex-1 text-sm"><span class="text-white/70">AI:</span> Hi! What can I help you with today?</div>
              </div>
              <div class="flex items-start gap-3">
                <div class="h-9 w-9 rounded-full bg-white/10 grid place-items-center">üë§</div>
                <div class="flex-1 text-sm">I need pricing and earliest availability.</div>
              </div>
              <div class="flex items-start gap-3">
                <div class="h-9 w-9 rounded-full bg-brand-500 grid place-items-center">ü§ñ</div>
                <div class="flex-1 text-sm">We can do tomorrow at <strong>2:00 PM</strong>. What‚Äôs your full name, email, and phone?</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Features -->
  <section id="features" class="py-20 md:py-28">
    <div class="mx-auto max-w-7xl px-4">
      <h2 class="text-3xl md:text-4xl font-bold tracking-tight">Built for any business, anywhere.</h2>
      <p class="mt-3 text-white/70 max-w-2xl">The AI receptionist collects details, quotes ranges, schedules, confirms, and hands off to a human when needed.</p>
      <div class="mt-10 grid md:grid-cols-3 gap-6">
        <div class="glass rounded-2xl p-6"><h3 class="font-semibold">üìû Missed inquiry recovery</h3><p class="mt-2 text-white/70 text-sm">Instant responses by web, SMS, or chat widget.</p></div>
        <div class="glass rounded-2xl p-6"><h3 class="font-semibold">üìÖ Calendar & CRM ready</h3><p class="mt-2 text-white/70 text-sm">Google Calendar node pre-wired (connect your creds).</p></div>
        <div class="glass rounded-2xl p-6"><h3 class="font-semibold">üß† Trained on your info</h3><p class="mt-2 text-white/70 text-sm">Your services, prices, policies, and tone‚Äîno code.</p></div>
      </div>
    </div>
  </section>

  <!-- AI BUILDER -->
  <section id="builder" class="py-20 md:py-28">
    <div class="mx-auto max-w-6xl px-4">
      <div class="glass rounded-2xl p-6 md:p-10">
        <div class="flex items-start justify-between gap-8 flex-col lg:flex-row">
          <!-- Form -->
          <div class="w-full lg:w-1/2">
            <h2 class="text-3xl font-bold tracking-tight">Build your AI Receptionist</h2>
            <p class="mt-2 text-white/70">Preview for free, hear an ElevenLabs voice intro, and pay once to unlock downloads.</p>

            <form id="aiForm" class="grid gap-3 mt-6">
              <div class="grid md:grid-cols-2 gap-3">
                <input class="rounded-xl bg-white/5 border border-white/10 px-4 py-3 placeholder-white/40" placeholder="Business name" name="bizName" required>
                <input class="rounded-xl bg-white/5 border border-white/10 px-4 py-3 placeholder-white/40" placeholder="Location / Service area" name="location" required>
              </div>

              <div class="grid md:grid-cols-2 gap-3">
                <input name="industry" class="rounded-xl bg-white/5 border border-white/10 px-4 py-3 placeholder-white/40" placeholder="Industry (e.g., Cleaning, SaaS, Clinic)" required>
                <input name="services" class="rounded-xl bg-white/5 border border-white/10 px-4 py-3 placeholder-white/40" placeholder="Core services (comma-separated)" required>
              </div>

              <div class="grid md:grid-cols-2 gap-3">
                <input name="agentName" class="rounded-xl bg-white/5 border border-white/10 px-4 py-3 placeholder-white/40" placeholder="Agent name (e.g., Alex)" value="Alex">
                <input name="language" class="rounded-xl bg-white/5 border border-white/10 px-4 py-3 placeholder-white/40" placeholder="Language (e.g., English, Spanish)" value="English">
              </div>

              <textarea name="pricing" rows="2" class="rounded-xl bg-white/5 border border-white/10 px-4 py-3 placeholder-white/40" placeholder="Typical price ranges or plans (optional)"></textarea>

              <div class="grid md:grid-cols-2 gap-3">
                <input name="hours" class="rounded-xl bg-white/5 border border-white/10 px-4 py-3 placeholder-white/40" placeholder="Hours (e.g., Mon‚ÄìSat 9‚Äì6)">
                <input name="calendarLink" class="rounded-xl bg-white/5 border border-white/10 px-4 py-3 placeholder-white/40" placeholder="Booking link (Google/Calendly)">
              </div>

              <div class="grid md:grid-cols-2 gap-3">
                <input name="email" type="email" class="rounded-xl bg-white/5 border border-white/10 px-4 py-3 placeholder-white/40" placeholder="Confirmation email (optional)">
                <input name="phone" inputmode="tel" class="rounded-xl bg-white/5 border border-white/10 px-4 py-3 placeholder-white/40" placeholder="Business phone (optional)">
              </div>

              <div class="grid md:grid-cols-2 gap-3">
                <input name="timezone" class="rounded-xl bg-white/5 border border-white/10 px-4 py-3 placeholder-white/40" placeholder="Timezone (e.g., America/New_York)">
                <textarea name="policies" rows="2" class="rounded-xl bg-white/5 border border-white/10 px-4 py-3 placeholder-white/40" placeholder="Deposits / refunds / service area / compliance (optional)"></textarea>
              </div>

              <div class="grid md:grid-cols-2 gap-3">
                <label class="flex items-center gap-2 text-sm"><input type="checkbox" name="upsell_a" class="accent-brand-500"> Offer upsells / add-ons</label>
                <label class="flex items-center gap-2 text-sm"><input type="checkbox" name="handoff" class="accent-brand-500" checked> Enable human handoff</label>
              </div>

              <!-- Voice selection -->
              <div class="grid md:grid-cols-3 gap-3 items-end">
                <div>
                  <label class="text-xs text-white/60">ElevenLabs Voice ID</label>
                  <input id="voiceId" class="w-full rounded-xl bg-white/5 border border-white/10 px-4 py-3 placeholder-white/40"
                         placeholder="e.g. 21m00Tcm4TlvDq8ikWAM">
                </div>
                <div>
                  <label class="text-xs text-white/60">Model</label>
                  <select id="modelId" class="w-full rounded-xl bg-white/10 border border-white/10 px-4 py-3">
                    <option value="eleven_multilingual_v2" selected>eleven_multilingual_v2</option>
                    <option value="eleven_flash_v2_5">eleven_flash_v2_5</option>
                    <option value="eleven_turbo_v2">eleven_turbo_v2</option>
                  </select>
                </div>
                <div>
                  <label class="text-xs text-white/60">Stability (0‚Äì1)</label>
                  <input id="stability" type="number" min="0" max="1" step="0.05" value="0.5"
                         class="w-full rounded-xl bg-white/5 border border-white/10 px-4 py-3">
                </div>
              </div>

              <div class="mt-4 flex flex-wrap gap-3">
                <button id="previewBtn" type="button" class="px-5 py-3 rounded-xl bg-brand-500 hover:bg-brand-600 font-medium">Preview</button>
                <button id="ttsBtn" type="button" class="px-5 py-3 rounded-xl border border-white/10 hover:bg-white/5">‚ñ∂ Hear AI Greeting (ElevenLabs)</button>
                <button id="downloadPromptBtn" type="button" class="px-5 py-3 rounded-xl border border-white/10 hover:bg-white/5" disabled>Download Prompt (.txt)</button>
                <button id="downloadJsonBtn" type="button" class="px-5 py-3 rounded-xl border border-white/10 hover:bg-white/5" disabled>Download n8n (.json)</button>
              </div>

              <!-- Audio player + download -->
              <div id="audioWrap" class="mt-3 hidden">
                <audio id="audio" controls class="w-full"></audio>
                <a id="audioDownload" download="ai-greeting.mp3" class="inline-block mt-2 text-sm underline decoration-brand-400">Download audio</a>
              </div>

              <!-- Paywall -->
              <div id="paywall" class="mt-6 p-4 rounded-xl border border-white/10 bg-white/5">
                <div class="text-sm mb-3">To unlock prompt & n8n downloads, complete purchase:</div>
                <stripe-buy-button
                  buy-button-id="buy_btn_1SPzZiIpVNL8emy1w6rFZbiB"
                  publishable-key="pk_live_51SNnUTIpVNL8emy1p6TV1AUq714WVbxPRlWPDfakrubfe52E0Bnl47PIlKhXazPSPaAd23JQSOsI0s8leA8IyPf6001U3zIzzX">
                </stripe-buy-button>
                <div class="text-xs text-white/50 mt-3">Set Buy Button <em>success URL</em> to this page with <code>?paid=1</code> to auto-unlock.</div>
              </div>
            </form>
          </div>

          <!-- Preview -->
          <div class="w-full lg:w-1/2">
            <div class="glass rounded-2xl p-5 h-full">
              <h3 class="text-xl font-semibold">Live Preview</h3>
              <div class="mt-3">
                <h4 class="text-sm text-white/60 mb-2">System Prompt</h4>
                <div id="promptOut" class="code text-sm bg-black/30 rounded-xl p-4 border border-white/10 min-h-[200px]"></div>
              </div>
              <div class="mt-6">
                <h4 class="text-sm text-white/60 mb-2">n8n Workflow JSON</h4>
                <div id="jsonOut" class="code text-xs bg-black/30 rounded-xl p-4 border border-white/10 min-h-[200px] overflow-auto"></div>
              </div>
              <div id="notice" class="mt-4 text-xs text-white/60"></div>
            </div>
          </div>
        </div>
      </div>

      <div class="mt-6 text-center text-white/60 text-sm">
        Prefer a done-for-you install? <a class="underline decoration-brand-400" href="https://calendly.com/razerrtrading/30min" target="_blank">Book a call</a>.
      </div>
    </div>
  </section>

  <!-- FAQ -->
  <section id="faq" class="py-20 md:py-28 bg-white/5">
    <div class="mx-auto max-w-4xl px-4">
      <h2 class="text-3xl font-bold tracking-tight text-center">FAQ</h2>
      <div class="mt-8 divide-y divide-white/10">
        <details class="group py-4">
          <summary class="flex justify-between cursor-pointer"><span>Which ElevenLabs model should I use?</span><span class="transition group-open:rotate-180">‚åÑ</span></summary>
          <p class="mt-2 text-white/70 text-sm">Default is <code>eleven_multilingual_v2</code> for natural, multilingual speech. Try <code>eleven_flash_v2_5</code> for speed.</p>
        </details>
        <details class="group py-4">
          <summary class="flex justify-between cursor-pointer"><span>How do I get a Voice ID?</span><span class="transition group-open:rotate-180">‚åÑ</span></summary>
          <p class="mt-2 text-white/70 text-sm">From ElevenLabs ‚ÄúMy Voices‚Äù ‚Üí three dots ‚Üí ‚ÄúCopy voice ID‚Äù, or use the List Voices API.</p>
        </details>
      </div>
    </div>
  </section>

  <footer class="py-10 text-center text-white/40 text-sm">¬© <span id="year"></span> AOS ‚Äî AI Optimization Solutions</footer>

  <script>
    // ------- Helpers -------
    document.getElementById('year').textContent = new Date().getFullYear();

    const form = document.getElementById('aiForm');
    const previewBtn = document.getElementById('previewBtn');
    const ttsBtn = document.getElementById('ttsBtn');
    const downloadPromptBtn = document.getElementById('downloadPromptBtn');
    const downloadJsonBtn = document.getElementById('downloadJsonBtn');
    const promptOut = document.getElementById('promptOut');
    const jsonOut = document.getElementById('jsonOut');
    const notice = document.getElementById('notice');
    const paywall = document.getElementById('paywall');
    const audioEl = document.getElementById('audio');
    const audioWrap = document.getElementById('audioWrap');
    const audioDownload = document.getElementById('audioDownload');

    // Default timezone
    const tzGuess = Intl.DateTimeFormat().resolvedOptions().timeZone || "UTC";
    if (!form.timezone.value) form.timezone.value = tzGuess;

    // Unlock logic: ?paid=1 OR localStorage flag
    const params = new URLSearchParams(window.location.search);
    const hasPaidParam = params.get('paid') === '1';
    const paidKey = 'aos_ai_paid';
    if (hasPaidParam) localStorage.setItem(paidKey, 'true');
    const isUnlocked = hasPaidParam || localStorage.getItem(paidKey) === 'true';
    setUnlocked(isUnlocked);

    function setUnlocked(unlocked){
      downloadPromptBtn.disabled = !unlocked;
      downloadJsonBtn.disabled = !unlocked;
      paywall.style.display = unlocked ? 'none' : 'block';
      notice.textContent = unlocked
        ? "Downloads unlocked. You can save your custom prompt and n8n workflow."
        : "Preview & voice demo are free. Complete purchase to enable downloads.";
    }

    function getValues() {
      const data = Object.fromEntries(new FormData(form).entries());
      data.upsells = form.upsell_a?.checked ? ["Relevant add-ons"] : [];
      data.handoff = !!form.handoff?.checked;
      if (!data.timezone) data.timezone = tzGuess;
      if (!data.language) data.language = "English";
      if (!data.agentName) data.agentName = "Alex";
      return data;
    }

    function buildPrompt(v) {
      const upsellLine = v.upsells.length ? `Offer relevant add-ons when appropriate.` : "";
      const pricingLine = v.pricing
        ? `Use these price ranges to quote: ${v.pricing}. Do not invent numbers beyond these; if unsure, say you'll confirm.`
        : `Provide estimate ranges conservatively; confirm exact amounts before booking.`;
      const policies = v.policies ? `Policies to respect: ${v.policies}` : `Be courteous, concise, and transparent.`;
      const handoff = v.handoff ? `If conversation becomes complex or sensitive, route to a human immediately.` : ``;

      return `Role
You are the AI Receptionist (‚Äú${v.agentName}‚Äù) for "${v.bizName}", a ${v.industry} business in ${v.location}. Communicate in ${v.language}. Your job is to greet, qualify, price within guidance, and book.

Current Time
{{ "now" | date: "%A, %B %d, %Y, %I:%M %p", "${v.timezone}" }}

Voice & Persona
Warm, professional, and concise (1‚Äì2 sentences). Natural human tone. Use friendly fillers rarely (‚Äúsounds good‚Äù, ‚Äúno worries‚Äù).

Always Collect
‚Ä¢ Full name ‚Ä¢ Email ‚Ä¢ Phone number ‚Ä¢ Requested service ‚Ä¢ Preferred date/time ‚Ä¢ Location/zip if needed

Capabilities
‚Ä¢ Recommend services from: ${v.services}.
‚Ä¢ ${pricingLine}
‚Ä¢ Confirm availability with the connected calendar; propose nearest alternatives if slot is taken.
‚Ä¢ Send confirmation message/email summarizing details.
${upsellLine}
${handoff}

Policies
${policies}

Links
Booking: ${v.calendarLink || "N/A"}
Business phone: ${v.phone || "N/A"}
Confirmation email sender: ${v.email || "N/A"}

Output Style
‚Ä¢ Short messages; avoid walls of text.
‚Ä¢ When ready to book: ‚ÄúI can lock in [DATE, TIME]. What‚Äôs your full name, email, and phone?‚Äù
‚Ä¢ After booking: ‚ÄúYou‚Äôre all set! A confirmation was sent to [email].‚Äù

Fail-safes
‚Ä¢ If unsure on price/policy/availability, say you‚Äôll confirm before scheduling.
‚Ä¢ Never provide medical/legal/financial advice; escalate if asked.
‚Ä¢ If outside service area or compliance rules, explain clearly and offer alternatives.

End of instructions.`;
    }

    function buildN8N(v, prompt) {
      return {
        name: `${v.bizName} ‚Äì AI Receptionist`,
        nodes: [
          { id: "Webhook_Trigger", name: "Incoming Message", type: "n8n-nodes-base.webhook", typeVersion: 1, position: [200, 300],
            parameters: { httpMethod: "POST", path: "ai-receptionist", responseMode: "onReceived", options: { responseCode: 200, responseData: "ok" } } },
          { id: "LLM_Chat", name: "LLM Chat (OpenAI)", type: "n8n-nodes-base.openAi", typeVersion: 4, position: [520, 300],
            parameters: { operation: "chat", model: "gpt-4o-mini", systemMessage: prompt, text: "={{$json.message || $json.text || $json.body || ''}}", temperature: 0.4 },
            credentials: { openAIApi: { id: "__CONNECT_IN_N8N__", name: "OpenAI" } } },
          { id: "Router", name: "Intent Router", type: "n8n-nodes-base.if", typeVersion: 1, position: [780, 300],
            parameters: { conditions: { string: [
              { value1: "={{$json.data || $json || ''}}", operation: "contains", value2: "book" },
              { value1: "={{$json.data || $json || ''}}", operation: "contains", value2: "schedule" }
            ] } } },
          { id: "Google_Calendar", name: "Create Event", type: "n8n-nodes-base.googleCalendar", typeVersion: 3, position: [1040, 240],
            parameters: { operation: "create", calendarId: "", start: "={{$json.preferredStart || $json.requestedStart}}", end: "={{$json.preferredEnd || $json.requestedEnd}}",
              summary: `={{"${v.bizName} ‚Äì "+($json.service||"Appointment")}}`, description: "={{$json.name+\" | \"+$json.email+\" | \"+$json.phone}}",
              options: { timezone: v.timezone || "UTC" } },
            credentials: { googleCalendarOAuth2Api: { id: "__CONNECT_IN_N8N__", name: "Google Calendar" } } },
          { id: "Email", name: "Send Confirmation", type: "n8n-nodes-base.emailSend", typeVersion: 2, position: [1280, 240],
            parameters: { fromEmail: v.email || "no-reply@yourdomain.com", toEmail: "={{$json.email}}", subject: `${v.bizName} ‚Äì Appointment Confirmed`,
              text: `={{"Hi "+$json.name+", your "+($json.service||"appointment")+" is confirmed for "+($json.confirmedTime||$json.preferredStart)+". If you need changes, reply to this email. ‚Äì ${v.bizName}"}}` },
            credentials: { smtp: { id: "__CONNECT_IN_N8N__", name: "SMTP" } } },
          { id: "Return_Response", name: "HTTP Response", type: "n8n-nodes-base.respondToWebhook", typeVersion: 1, position: [1280, 380],
            parameters: { responseBody: "={{$json.reply || $json.data || $json || \"Thanks! We'll be in touch.\"}}", responseCode: 200 } }
        ],
        connections: {
          "Incoming Message": { main: [[{ node: "LLM Chat (OpenAI)", type: "main", index: 0 }]] },
          "LLM Chat (OpenAI)": { main: [[{ node: "Intent Router", type: "main", index: 0 }]] },
          "Intent Router": { main: [
            [{ node: "Create Event", type: "main", index: 0 }],
            [{ node: "HTTP Response", type: "main", index: 0 }]
          ] },
          "Create Event": { main: [[{ node: "Send Confirmation", type: "main", index: 0 }]] },
          "Send Confirmation": { main: [[{ node: "HTTP Response", type: "main", index: 0 }]] }
        },
        settings: { timezone: v.timezone || "UTC" }
      };
    }

    function toBlobDownload(filename, content, mime="text/plain") {
      const blob = new Blob([content], {type: mime});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = filename;
      document.body.appendChild(a); a.click(); a.remove();
      URL.revokeObjectURL(url);
    }

    function preview() {
      const v = getValues();
      const prompt = buildPrompt(v);
      const json = buildN8N(v, prompt);
      promptOut.textContent = prompt;
      jsonOut.textContent = JSON.stringify(json, null, 2);
      notice.textContent = downloadPromptBtn.disabled
        ? "Looks good! ElevenLabs voice preview is available. Complete purchase to enable downloads."
        : "Ready to download. Import the JSON in n8n.";
    }
    previewBtn.addEventListener('click', preview);

    downloadPromptBtn.addEventListener('click', () => {
      const v = getValues();
      const prompt = buildPrompt(v);
      toBlobDownload(`${(v.bizName||"AI_Receptionist").replace(/\s+/g,'_')}_prompt.txt`, prompt, "text/plain;charset=utf-8");
    });

    downloadJsonBtn.addEventListener('click', () => {
      const v = getValues();
      const prompt = buildPrompt(v);
      const json = buildN8N(v, prompt);
      toBlobDownload(`${(v.bizName||"AI_Receptionist").replace(/\s+/g,'_')}_n8n.json`, JSON.stringify(json, null, 2), "application/json");
    });

    // ------- ElevenLabs TTS preview (via /api/tts) -------
    async function elevenLabsPreview() {
      const v = getValues();
      const voiceId = document.getElementById('voiceId').value.trim() || '21m00Tcm4TlvDq8ikWAM'; // default classic voice
      const modelId = document.getElementById('modelId').value || 'eleven_multilingual_v2';
      const stability = parseFloat(document.getElementById('stability').value || '0.5');

      const text = `Hey, this is ${v.agentName || "Alex"} with ${v.bizName || "your business"}, how can I help you today?`;

      const res = await fetch('/api/tts', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({
          text, voice_id: voiceId, model_id: modelId,
          voice_settings: { stability, similarity_boost: 0.7 }
        })
      });

      if (!res.ok) {
        const errTxt = await res.text().catch(()=>res.statusText);
        alert('TTS error: ' + errTxt);
        return;
      }

      const blob = await res.blob(); // audio/mpeg
      const url = URL.createObjectURL(blob);
      audioEl.src = url;
      audioWrap.classList.remove('hidden');
      audioEl.play().catch(()=>{ /* user must click play on some browsers */ });
      audioDownload.href = url;
    }

    const ttsBtnEl = document.getElementById('ttsBtn');
    ttsBtnEl.addEventListener('click', elevenLabsPreview);

    function getValues() {
      const data = Object.fromEntries(new FormData(form).entries());
      data.upsells = form.upsell_a?.checked ? ["Relevant add-ons"] : [];
      data.handoff = !!form.handoff?.checked;
      if (!data.timezone) data.timezone = tzGuess;
      if (!data.language) data.language = "English";
      if (!data.agentName) data.agentName = "Alex";
      return data;
    }
  </script>
</body>
</html>
