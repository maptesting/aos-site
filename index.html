<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AOS â€” AI Receptionist Prompt Pack (Free Builder)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            brand: { 500: "#556dff", 600: "#3d4fe6" },
            ink: "#0b0f1a"
          },
          boxShadow: { soft: "0 8px 30px rgba(0,0,0,.18)" }
        }
      }
    }
  </script>
  <style>
    body{background:#0b0f1a;color:#fff}
    .gradient{background:
      radial-gradient(1200px 600px at 20% -10%, rgba(85,109,255,.25), transparent 60%),
      radial-gradient(1000px 600px at 100% 0%, rgba(34,42,130,.35), transparent 60%);}
    .glass{backdrop-filter:blur(10px);background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08)}
    .code{white-space:pre-wrap;font-family:ui-monospace,Menlo,Consolas,monospace}
    input,textarea{background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.1);border-radius:12px;padding:.75rem 1rem}
    input::placeholder,textarea::placeholder{color:rgba(255,255,255,.4)}
    input:focus,textarea:focus{outline:none;box-shadow:0 0 0 2px rgba(85,109,255,.5)}
  </style>
</head>
<body>
  <header class="gradient border-b border-white/10">
    <div class="max-w-6xl mx-auto px-4 py-6 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="w-9 h-9 rounded-xl bg-brand-500 grid place-items-center">ðŸ¤–</div>
        <div>
          <div class="font-semibold">AOS</div>
          <div class="text-white/60 text-xs">AI Optimization Solutions</div>
        </div>
      </div>
      <a href="#builder" class="px-4 py-2 rounded-xl bg-brand-500 hover:bg-brand-600">Build Free</a>
    </div>
  </header>

  <section class="gradient">
    <div class="max-w-6xl mx-auto px-4 py-14 grid md:grid-cols-2 gap-10 items-center">
      <div>
        <h1 class="text-4xl md:text-5xl font-extrabold leading-tight">
          AI Receptionist Prompt Pack â€” <span class="text-brand-500">Free Builder</span>
        </h1>
        <p class="mt-4 text-white/70 max-w-xl">
          Answer a few questions about your business. Get a production-ready System Prompt (preview) and
          download two **n8n** workflows â€” <em>checkAvailability</em> and <em>bookAppointment</em>.
          Works with any industry, anywhere.
        </p>
        <div class="mt-6">
          <a href="#builder" class="px-5 py-3 rounded-xl bg-brand-500 hover:bg-brand-600">Start Building</a>
        </div>
      </div>
      <div class="glass rounded-2xl p-6 shadow-soft">
        <div class="text-sm text-white/60">Sample conversation</div>
        <div class="mt-3 space-y-3 text-sm">
          <div class="flex gap-3"><div class="w-8 h-8 rounded-full bg-brand-500 grid place-items-center">ðŸ¤–</div><div>Hi! This is Alex with Hemsted Window Tinting â€” how can I help?</div></div>
          <div class="flex gap-3"><div class="w-8 h-8 rounded-full bg-white/10 grid place-items-center">ðŸ‘¤</div><div>Earliest tint appointment this week?</div></div>
          <div class="flex gap-3"><div class="w-8 h-8 rounded-full bg-brand-500 grid place-items-center">ðŸ¤–</div><div>We can do Thu 2:00 PM or Fri 10:30 AM. Want me to book one?</div></div>
        </div>
      </div>
    </div>
  </section>

  <section id="builder" class="py-16">
    <div class="max-w-6xl mx-auto px-4">
      <div class="glass rounded-2xl p-6 md:p-8">
        <div class="grid lg:grid-cols-2 gap-8">
          <!-- Left: Form -->
          <div>
            <h2 class="text-2xl font-bold">Your Business</h2>
            <form id="aiForm" class="grid gap-3 mt-4">
              <input name="bizName" placeholder="Business Name" required>
              <input name="location" placeholder="Location / Service area" required>
              <input name="industry" placeholder="Industry (e.g., salon, rentals, clinic)" required>
              <input name="services" placeholder="Services (comma-separated)" required>
              <div class="grid md:grid-cols-2 gap-3">
                <input name="agentName" placeholder="Agent Name" value="Alex">
                <input name="language" placeholder="Language" value="English">
              </div>
              <div class="grid md:grid-cols-2 gap-3">
                <input name="hours" placeholder="Hours (e.g., Monâ€“Sat 9â€“6)">
                <input name="timezone" placeholder="Timezone (e.g., America/New_York)">
              </div>
              <div class="grid md:grid-cols-2 gap-3">
                <input name="calendarId" placeholder="Google Calendar ID (e.g., primary)">
                <input name="email" type="email" placeholder="Confirmation email sender (optional)">
              </div>
              <textarea name="policies" rows="2" placeholder="Policies / deposits / refunds (optional)"></textarea>

              <div class="mt-2 flex gap-3 flex-wrap">
                <button type="button" id="previewBtn" class="px-4 py-2 rounded-xl bg-brand-500 hover:bg-brand-600">Generate Preview</button>
                <button type="button" id="ttsBtn" class="px-4 py-2 rounded-xl border border-white/10 hover:bg-white/5">â–¶ Hear AI Greeting</button>
              </div>
            </form>
          </div>

          <!-- Right: Preview + Downloads -->
          <div>
            <div class="glass rounded-2xl p-4">
              <h3 class="font-semibold">System Prompt â€” Preview</h3>
              <div class="text-xs text-white/60">Preview only (truncated)</div>
              <div id="promptOut" class="code text-sm bg-black/30 rounded-xl p-3 border border-white/10 min-h-[180px] mt-3"></div>

              <div class="mt-4">
                <h4 class="text-sm text-white/70 mb-2">Downloads</h4>
                <div class="flex flex-wrap gap-2">
                  <button id="downloadPromptBtn" class="px-3 py-2 rounded-xl bg-brand-500/80 hover:bg-brand-600 disabled:opacity-50" disabled>Download Full Prompt (.txt)</button>
                  <button id="downloadAvailBtn" class="px-3 py-2 rounded-xl border border-white/10 hover:bg-white/5 disabled:opacity-50" disabled>Download: checkAvailability.json</button>
                  <button id="downloadBookBtn" class="px-3 py-2 rounded-xl border border-white/10 hover:bg-white/5 disabled:opacity-50" disabled>Download: bookAppointment.json</button>
                </div>
              </div>

              <div class="mt-4">
                <div id="audioWrap" class="hidden">
                  <audio id="audio" controls class="w-full"></audio>
                  <a id="audioDownload" download="ai-greeting.mp3" class="inline-block mt-2 text-sm underline decoration-blue-400">Download audio</a>
                </div>
                <div id="notice" class="mt-2 text-xs text-white/60"></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <p class="text-center text-sm text-white/50 mt-6">
        After import, attach your Google Calendar OAuth2 and OpenAI credentials in n8n.
      </p>
    </div>
  </section>

  <script src="/js/builders.js"></script>
  <script>
    // wire UI <-> builders
    const form = document.getElementById('aiForm');
    const previewBtn = document.getElementById('previewBtn');
    const downloadPromptBtn = document.getElementById('downloadPromptBtn');
    const downloadAvailBtn = document.getElementById('downloadAvailBtn');
    const downloadBookBtn = document.getElementById('downloadBookBtn');
    const promptOut = document.getElementById('promptOut');
    const audio = document.getElementById('audio');
    const audioWrap = document.getElementById('audioWrap');
    const audioDownload = document.getElementById('audioDownload');
    const notice = document.getElementById('notice');

    if(!form.timezone.value){ try{ form.timezone.value = Intl.DateTimeFormat().resolvedOptions().timeZone || ""; }catch(_){} }

    function values(){ return Object.fromEntries(new FormData(form).entries()); }

    previewBtn.addEventListener('click', () => {
      const v = values();
      const prompt = window.AOS.buildPrompt(v);
      promptOut.textContent = window.AOS.truncate(prompt);
      downloadPromptBtn.disabled = false;
      downloadAvailBtn.disabled = false;
      downloadBookBtn.disabled = false;

      downloadPromptBtn.onclick = () => {
        const blob = new Blob([prompt], {type:"text/plain;charset=utf-8"});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a'); a.href = url;
        a.download = `${(v.bizName||'AI_Receptionist')}_prompt.txt`; a.click();
        URL.revokeObjectURL(url);
      };

      const availJSON = window.AOS.buildCheckAvailability(v);
      const bookJSON = window.AOS.buildBookAppointment(v);

      downloadAvailBtn.onclick = () => {
        const url = URL.createObjectURL(new Blob([JSON.stringify(availJSON,null,2)],{type:"application/json"}));
        const a = document.createElement('a'); a.href = url; a.download = "checkAvailability.json"; a.click();
        URL.revokeObjectURL(url);
      };
      downloadBookBtn.onclick = () => {
        const url = URL.createObjectURL(new Blob([JSON.stringify(bookJSON,null,2)],{type:"application/json"}));
        const a = document.createElement('a'); a.href = url; a.download = "bookAppointment.json"; a.click();
        URL.revokeObjectURL(url);
      };

      notice.textContent = "Downloads ready. Import into n8n â†’ connect Google Calendar Tool + OpenAI creds.";
    });

    // simple ElevenLabs preview using your /api/tts route
    document.getElementById('ttsBtn').addEventListener('click', async () => {
      const v = values();
      const text = `Hey, this is ${v.agentName||'Alex'} with ${v.bizName||'your business'}. How can I help you today?`;
      const res = await fetch('/api/tts', {
        method: 'POST', headers:{'Content-Type':'application/json'},
        body: JSON.stringify({ text, voice_id:'21m00Tcm4TlvDq8ikWAM', model_id:'eleven_multilingual_v2', voice_settings:{ stability:0.5, similarity_boost:0.7 } })
      });
      if(!res.ok){ alert('TTS error: ' + (await res.text())); return; }
      const blob = await res.blob(); const url = URL.createObjectURL(blob);
      audio.src = url; audioWrap.classList.remove('hidden'); audio.play().catch(()=>{});
      audioDownload.href = url;
    });
  </script>
</body>
</html>
